{
  "config": {
    "model": {
      "name": "Qwen/Qwen2.5-0.5B-Instruct",
      "description": "Small 0.5B model for fast benchmarking",
      "alternatives": [
        "Qwen/Qwen2.5-1.5B-Instruct",
        "microsoft/phi-2",
        "TinyLlama/TinyLlama-1.1B-Chat-v1.0"
      ]
    },
    "generation": {
      "max_new_tokens": 256,
      "temperature": 0.7,
      "top_p": 0.9,
      "do_sample": true,
      "repetition_penalty": 1.1
    },
    "prompt": {
      "system_template": "You are a helpful smart home assistant. Help the user control their devices by understanding their preferences and the current context.",
      "format": "chat",
      "include_context": true,
      "max_context_messages": 5
    },
    "evaluation": {
      "metrics": [
        "embedding_similarity",
        "action_accuracy"
      ],
      "embedding_model": "sentence-transformers/all-MiniLM-L6-v2",
      "compute_per_user": true
    },
    "data": {
      "dialogues_file": "data/cleaned/dialogs_clean.jsonl",
      "splits_file": "data/splits/edgesplits.json",
      "eval_split": "test",
      "max_examples": null
    },
    "device": "auto",
    "batch_size": 8,
    "seed": 42
  },
  "lora_model_path": "models\\lora_unified",
  "metrics": {
    "embedding_similarity": 0.8213821053504944,
    "device_precision": 0.9380334681042228,
    "device_recall": 0.9354784366576819,
    "param_precision": 0.9058737646001797,
    "param_recall": 0.9030211141060198,
    "param_f1": 0.8957910837290892,
    "numerical_tp_total": 1976,
    "numerical_fp_total": 369,
    "numerical_fn_total": 338,
    "numerical_precision": 0.2935478436657682,
    "numerical_recall": 0.292705525606469,
    "numerical_f1": 0.2914532794249775,
    "numerical_mae": 19.821428571428573,
    "categorical_tp_total": 4228,
    "categorical_fp_total": 430,
    "categorical_fn_total": 370,
    "categorical_precision": 0.5326538634321654,
    "categorical_recall": 0.5300567160826595,
    "categorical_f1": 0.5277956937491978,
    "device_tp": 4140,
    "device_fp": 255,
    "device_tn": 25046,
    "device_fn": 239,
    "device_precision_from_confusion": 0.9419795221843004,
    "device_recall_from_confusion": 0.9454213290705641,
    "device_accuracy": 0.983355795148248,
    "device_f1": 0.9436972874401641,
    "device_breakdown": {
      "tp": {
        "tv": 394,
        "ac": 669,
        "lights": 1112,
        "speaker": 781,
        "security": 1184
      },
      "fp": {
        "tv": 75,
        "ac": 44,
        "lights": 35,
        "speaker": 56,
        "security": 45
      },
      "tn": {
        "tv": 5427,
        "ac": 5178,
        "lights": 4741,
        "speaker": 5065,
        "security": 4635
      },
      "fn": {
        "tv": 40,
        "ac": 45,
        "lights": 48,
        "speaker": 34,
        "security": 72
      }
    },
    "avg_pred_length": 14.327830188679245,
    "avg_ref_length": 13.997304582210242,
    "length_ratio": 1.0236135181975736
  },
  "num_examples": 5936,
  "num_personas": 200
}